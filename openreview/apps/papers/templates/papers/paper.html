{% extends "base.html" %}
{% load markdown %}

{% load markdown %}

{% block css %}
    <link rel="stylesheet" href="{{ STATIC_URL }}papers/paper.css" />
    <link rel="stylesheet" href="{{ STATIC_URL }}papers/reviews.css" />
    <link rel="stylesheet" href="{{ STATIC_URL }}papers/comments.css" />
{% endblock %}

{% block js %}
    <script type="text/coffeescript" src="{{ STATIC_URL }}papers/voting.coffee"></script>
    <script type="text/coffeescript" src="{{ STATIC_URL }}papers/writing.coffee"></script>
    <script type="text/coffeescript" src="{{ STATIC_URL }}papers/deleting.coffee"></script>
    <script type="text/coffeescript" src="{{ STATIC_URL }}papers/commenting.coffee"></script>
    <script type="text/coffeescript" src="{{ STATIC_URL }}js/starratings.coffee"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}raty/lib/jquery.raty.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/jquery.dotdotdot.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function() {
        $(".abstract").dotdotdot({ after: "a.readmore" });
      });
    </script>
{% endblock %}

{% block content %}
    <section data-votes="{{ my_votes }}" data-reviews="{{ my_reviews }}" class="paper box">
        <header>
            <h1><a href="#" title="arXiv link">{{ paper.title|capfirst }}</a></h1>
        </header>
        <div class="abstract">
            {{ paper.abstract | markdown}}
            {% if paper.urls %}
            <a href="{{ paper.urls }}" class="readmore">&raquo; Read full abstract on {{ paper.get_url_domain }}</a>
            {% endif %}
        </div>
        <div class="meta">
            <ul>
                <li><strong>Authors:</strong> {{ paper.get_authors }}</li>
                <li><strong>Publication date:</strong> {{ paper.publish_date }}</li>
                <li><strong>Keywords:</strong>
                    <a href="#">Stochastic Frontier</a>,
                    <a href="#">Sample Selection</a>,
                    <a href="#">Simulation</a>,
                    <a href="#">Efficiency</a>
                </li>
            </ul>
        </div>
    </section>

    <section class="reviews box">
        <h2>{{ reviews|length }} review{{ reviews|length|pluralize }}</h2>

        {% for review in reviews %}
            {% include "papers/review.html" with review=review.review %}
        {% endfor %}
    </section>

    <aside>
      {% if related_a|length > 0 %}
      <div class="more-by-these-authors box">
          <h2>More by these authors</h2>
          <ol>
            {% for related_paper in related_a %}
                 <li><a href="{% url 'paper' related_paper.id %}">{{ related_paper.title }}</a></li>
            {% endfor %}          
          </ol>
      </div>
      {% endif %}

      {% if related_s|length > 0 %}
      <div class="related-papers box">
          <h2>Related papers</h2>
          <ol>
            {% for related_paper in related_s %}
                 <li><a href="{% url 'paper' related_paper.id %}">{{ related_paper.title }}</a></li>
            {% endfor %}          
          </ol>
      </div>
      {% endif %}
    </aside>

    <section class="compose-review box">
        <h2>Share your opinion by writing a review</h2>
        <div class="rating">★★★☆☆</div>
        <form action="#" method="POST">
            <textarea placeholder="Provide a professional opinion on this paper."></textarea>
            <label>
                <input type="checkbox" name="is_anonymously" />
                <span>Place anonymously</span>
            </label>
            <button type="submit">Submit review</button>
        </form>
    </section>

{% endblock %}
